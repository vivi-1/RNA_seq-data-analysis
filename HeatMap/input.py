#!/usr/bin/env python3# -*- coding: utf-8 -*-"""Created on Sun Jul 18 18:28:37 2021@author: weiwangRow.nameslog2FoldChange"""import pandas as pdimport xlsxwriterdef refList():    allist=[]    nutrientList=[]    PRlist=[]    nutrientList = pd.read_excel("/Users/weiwang/Desktop/GOI_Pnic.xlsx", sheet_name="Nutrient", usecols=['Gene_ID'])    PRlist = pd.read_excel("/Users/weiwang/Desktop/GOI_Pnic.xlsx", sheet_name="PR", usecols=['Gene_ID'])    nutrientList= nutrientList.stack().tolist()    PRlist = PRlist.stack().tolist()    allist=[nutrientList,PRlist]    print("list[0]: nutrient\nlist[1]: PR")    return allistdef compileFilenames():    path="/Volumes/WD1/Desktop/laboratory files/Results/Altria project/DEGlist/Wei_reDEGlist/Output/"    timepoints=[]    for i in range(1,8):        timepoints.append("T"+str(i)+" _")    treatments=["_Pnic_", "_Flag22_", "_Flag22_Pnic_"]    filenamesUp=[]    for i in timepoints:        for j in treatments:            filenamesUp.append(path+i+"all"+j+"no rep2.csv")    return filenamesUp    def getFC_treatment_timepoints():    fileName=compileFilenames()    ref_List=refList()    all_list_FC=[]    for filename in fileName:        geneList = pd.read_csv(filename, usecols=['Row.names'])        geneList = geneList.stack().tolist()        FCList = pd.read_csv(filename, usecols=['log2FoldChange'])        FCList = FCList.stack().tolist()        print(len(geneList), len(FCList))        print(filename)        list_FC=[]        for geneID in ref_List[0]: #change 0 or 1 for different GOIs            if geneID in geneList:                rowNo=geneList.index(geneID)                #print(rowNo)                FC = FCList[rowNo]            if geneID not in geneList:                FC = 'na'            list_FC.append(FC)        all_list_FC.append(list_FC)    return all_list_FC        def write_to_file():    workbook = xlsxwriter.Workbook('/Users/weiwang/Desktop/FC.xlsx')    worksheet = workbook.add_worksheet("log2FoldChange")    col=0    all_list_FC = getFC_treatment_timepoints()    print(all_list_FC)    for i in all_list_FC:        print(len(i))        for j in range(0,len(i)):            print(j)            worksheet.write(j, col, i[j])            worksheet.write(j, col, i[j])        col+=1        print(col)    workbook.close() write_to_file()